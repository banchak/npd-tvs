
  <div class="container-fluid" ng-show="dataReady">

        <div ng-include="'views/includes/edit-header.html'"> </div>
        
        <div><!--head-->
          <div class="row-fluid">
              <div class="span4">
                <label>
                  <span ng-class="!resource._type && 'text-error'">
                    ประเภท :
                    <span
                      ng-hide="resource._type" 
                      popover="ห้ามว่าง" popover-trigger="mouseenter" popover-placement="right"
                      > 
                      &lowast; 
                    </span>
                  </span>
                </label>
                <select class="input-medium"
                  required
                  ng-disabled = "!unlockEdit || resource.info.approved"
                  ng-model  ="resource._type" 
                  ng-options="c.name as c.name for c in BUILT_IN.contractTypes"
                ></select>
              </div>

              <div class="span4" ng-show="resource._type=='บันทึก'">
                <label>
                  <span ng-class="!resource.info.reference && 'text-error'">
                    อ้างถึงสัญญา : 
                    <span
                      ng-hide="resource.info.reference" 
                      popover="ห้ามว่าง" popover-trigger="mouseenter"  popover-placement="right"
                      > 
                      &lowast; 
                    </span>
                  </span>
                </label>
                <input type="text" class="input-medium" 
                  required
                  ng-disabled = "!unlockEdit || resource.info.approved"
                  ng-model="resource.info.reference" />
                <span></span>
              </div>

          </div>
          
          <div class="row-fluid">
              <div class="span4">
                <label>วันที่ทำสัญญา : </label>
                <input type="text" class="input-medium" 
                  ng-disabled = "resource.info.approved"
                  ng-model="resource.info.issue_date" 
                  moment="'DD/MM/**BB'"
                  typeahead="d.name as (d.label || d.name) 
                    for d in utils.dateListAhead($viewValue) | filter:$viewValue"
                  />
              </div>
            
              <div class="span4">
                <label>
                  <span ng-class="!resource._name && 'text-error'">
                    เลขที่ : 
                    <span
                      ng-hide="resource._name" 
                      popover="ห้ามว่าง" popover-trigger="mouseenter"  popover-placement="right"
                      > 
                      &lowast; 
                    </span>
                  </span>
                </label>
                <input type="text" class="input-medium" 
                  required
                  popover="ใส่ * เพื่อrun อัตโนมัติ" popover-trigger="focus"
                  ng-disabled = "!unlockEdit || resource.info.approved"
                  ng-model="resource._name" />
                <span></span>
              </div>
          </div>
        </div>

        <div class="row-fluid"><!--tabs menu-->

          <ul class="nav nav-tabs">
            <li ng-class="!__tabIdx && 'active'">
              <a href ng-click="__tabIdx=0">
                คู่สัญญา</a></li>
            <li ng-class="__tabIdx==1 && 'active'">
              <a href ng-click="__tabIdx=1">
                พื้นที่เช่า</a></li>
            <li ng-class="__tabIdx==2 && 'active'">
              <a href ng-click="__tabIdx=2">
                กำหนดเวลา</a></li>
            <li ng-class="__tabIdx==3 && 'active'"  ng-hide="resource._type=='บันทึก'">
              <a href ng-click="__tabIdx=3">
                สัญญามาตรฐาน</a></li>
            <li ng-class="__tabIdx==4 && 'active'">
              <a href ng-click="__tabIdx=4">
                <span class="label label-success" 
                  ng-show="custom().text"
                  >
                  &radic;
                </span>
                ร่างข้อความเอง</a></li>
            <li ng-class="__tabIdx==5 && 'active'">
              <a href ng-click="__tabIdx=5">
                ฝ่ายกฎหมาย</a></li>

          </ul>
        </div>

        <div class="row-fluid"><!--tabs body-->

          <div class="container-fluid" ng-show="!__tabIdx"  heading="คู่สัญญา">
              <label>คู่สัญญา :
                <span ng-show="resource.info.tenant_type && !resource.info.approved">
                  <span ng-show="tenant_addable()">
                    <a href="" class="btn btn-small btn-danger" 
                      ng-click="resource$entry.add(tenants())">
                      เพิ่มผู้เช่า</a>
                  </span>
                  <span>
                    <a href="" class="btn btn-small btn-danger" 
                      ng-click="resource$entry.add(tenant_signers())">
                      เพิ่มผู้ลงนาม</a>
                  </span>
                </span>
              </label>
              <div class="alert alert-info">
                <div class="input-prepend">
                  <span class="add-on">ประเภท</span>
                  <select class="input-medium"
                    ng-disabled = "resource.info.approved"
                    ng-model  ="resource.info.tenant_type" 
                    ng-options="c.name as c.name for c in BUILT_IN.personTypes"
                    ></select>
                </div>
              
                <div ng-repeat="tenant in tenants()">
                  <div class="pull-right" ng-show="!resource.info.approved">
                    <a tabindex="-1" class="btn btn-small btn-warning" href 
                      ng-click="resource$entry.remove(tenants(),$index)">
                      ลบ
                    </a>
                  </div>
                  
                  <div class="input-prepend input-append">
                    <form style="margin:0;" ng-submit="tenantSync(tenants()[$index])">
                      <div style="height:0; width:0; overflow:hidden;">
                        <input type="submit" />
                      </div>                          
                      <span class="add-on">ชื่อผู้เช่า</span>
                      <input type="text" class="input-xlarge" 
                        ng-disabled = "resource.info.approved"
                        ng-model="tenant.name"
                        typeahead="itm for itm in selfList('Tenant/_name', $viewValue,{_type : resource.info.tenant_type})"
                        typeahead-wait-ms="typeaheadWait"
                        />
                        <span class="add-on btn btn-small" 
                          ng-disabled = "resource.info.approved"
                          ng-class="!isSynced(tenant) && 'btn-info'"
                          ng-click="tenantSync(tenants()[$index],true)"
                          >
                          &crarr;
                        </span>
                      </form>
                  </div>
                  
                  <div class="input-prepend">
                    <span class="add-on">เลขสำคัญ</span>
                    <input type="text" class="input-medium" 
                      placeholder="{{ (resource.info.tenant_type=='นิติบุคคล' && 'เลขนิติบุคคล') || (resource.info.tenant_type=='บุคคล' && 'บัตรประชาชน') || '' }} " 
                      ng-disabled = "resource.info.approved"
                      ng-model="tenant.register_id"
                      />
                  </div>
                  
                  <div>
                    <div ng-show="tenant.$temp.data.meta.locations.length &gt; 1 && !resource.info.approved">
                      <ul class="nav nav-pills" style="margin:0;" >
                        <li 
                          ng-repeat="loc in tenant.$temp.data.meta.locations"
                          ng-class="(loc2Address(loc)==tenant.address)&&'active'">
                          <a href ng-click="tenant.address = loc2Address(loc)">
                            {{ loc.type || ($index +1) }}
                          </a>
                        </li>
                      </ul>
                    </div>
                    <div class="input-prepend" ng-class="(tenant.$temp.data.meta.locations.length > 1) && 'input-append'">
                      <span class="add-on">ที่อยู่</span>
                      <textarea rows="2.5" class="input-xxlarge" 
                        ng-disabled = "resource.info.approved"
                        ng-model="tenant.address" 
                        ></textarea>
                    </div>
                  </div>
                  <hr/>
                </div>
                <div ng-repeat="signer in tenant_signers()">
                  <div class="pull-right">
                    <a tabindex="-1" class="btn btn-small btn-warning" href 
                      ng-click="resource$entry.remove(tenant_signers(),$index)"
                      >
                      ลบ
                    </a>
                  </div>

                  <div class="input-prepend input-append">
                    <form style="margin:0;" ng-submit="tenantSync(tenant_signers()[$index])">
                      <div style="height:0; width:0; overflow:hidden;">
                        <input type="submit" />
                      </div>                          
                      <span class="add-on">ผู้ลงนาม</span>
                      <input type="text" class="input-xlarge" placeholder="กรรมการ หรือ ผู้รับมอบอำนาจ(ถ้ามี)" 
                        ng-model="signer.name" 
                        typeahead="itm for itm in selfList('Tenant/_name', $viewValue,{_type : 'บุคคล'})"
                        typeahead-wait-ms="typeaheadWait"
                        />
                      <span class="add-on btn btn-small" 
                        ng-class="!isSynced(signer) && 'btn-info'"
                        ng-click="tenantSync(tenant_signers()[$index],true)"
                        >
                        &crarr;
                      </span>
                    </form>
                  </div>
                </div>
              </div>
              
              <div>
                <textarea rows="5" class="input-xxlarge" 
                  ng-disabled = "resource.info.approved"
                  ng-model="resource.display.tenant" 
                  >
                </textarea>
                <span class="help-inline">
                  ข้อความคู่สัญญาที่แสดง
                </span>
              </div>


              <div>
                <label>ลงนามผู้ทำสัญญา :
                </label>
                <input type="text" class="input-xlarge" 
                  ng-model="resource.info.signer1"
                  typeahead="itm for itm in selfList('info.signer1',$viewValue)"
                  typeahead-wait-ms="typeaheadWait"
                   />
              </div>

              <label>
                ลงนามคู่สัญญา :
                <span ng-hide="(sumSigner2() || resource.info.signer2) == resource.info.signer2">
                  <a href class="btn btn-small btn-info" ng-click="resource.info.signer2 = sumSigner2()">sync</a>
                </span>
              </label>
              <input type="text" class="input-xxlarge" 
                ng-model="resource.info.signer2"
                 />

              <label>ลงนามพยาน :  
                <span>
                  <a href="" class="btn btn-small btn-danger" ng-click="resource$entry.add(witnesses())">เพิ่ม</a>
                </span>
              </label>
              <div class="alert alert-info" ng-show="witnesses().length">
                <div ng-repeat="witness in witnesses()">
                  <div class="pull-right">
                    <a tabindex="-1" class="btn btn-small btn-warning" href
                      ng-click="resource$entry.remove(witnesses(),$index)">
                      ลบ
                    </a>
                  </div>
                  <input type="text" class="input-xlarge"  
                      ng-model="witness.name"
                      typeahead="itm for itm in selfList('meta.witnesses.name',$viewValue)"
                      typeahead-wait-ms="typeaheadWait"
                       />
                </div>
              </div>
          </div>

          <div class="container-fluid" ng-show="__tabIdx==1" heading="พื้นที่เช่า">
              <label>พื้นที่เช่า :
                <span ng-show="!resource.info.approved">
                  <a href="" class="btn btn-small btn-danger" ng-click="resource$entry.add(areas())">เพิ่มห้อง</a>
                </span>
              </label>
              
              <div class="alert alert-info" ng-show="areas().length">
                <div ng-repeat="area in areas()">
                  <hr ng-show="$index && !resource.info.approved" />
                  <div class="pull-right">
                    <a tabindex="-1" class="btn btn-small btn-warning" href 
                      ng-click="resource$entry.remove(areas(),$index)">
                      ลบ
                    </a>
                  </div>
                  <div class="input-prepend input-append">
                    <form style="margin:0;" ng-submit="meta_room_to_floor_building(area)">
                      <div style="height:0; width:0; overflow:hidden;">
                        <input type="submit" />
                      </div>                          

                      <span class="add-on">ห้อง</span>
                      <input type="text" class="input-small" 
                        ng-disabled = "resource.info.approved"
                        ng-model="area.room"
                        />
                      <span class="add-on btn" 
                        ng-disabled = "resource.info.approved"
                        ng-class="!isSynced(area,'room') && 'btn-info'"
                        ng-click="meta_room_to_floor_building(area, true)"
                        >
                        &crarr;
                      </span>
                    </form>
                  </div>
                  
                  <div class="input-prepend">
                    <span class="add-on">โซน</span>
                    <input type="text" class="input-mini" 
                      ng-disabled = "resource.info.approved"
                      ng-model="area.zone"
                      typeahead="itm for itm in selfList('meta.areas.zone',$viewValue)"
                      typeahead-wait-ms="typeaheadWait"
                      />
                  </div>
                  
                  <div class="input-prepend">
                    <span class="add-on">ชั้น</span>
                    <input type="text" class="input-mini" 
                      ng-disabled = "resource.info.approved"
                      ng-model="area.floor"
                      />
                  </div>
                  
                  <div class="input-prepend">
                    <span class="add-on">อาคาร</span>
                    <input type="text" class="input-mini" 
                      ng-disabled = "resource.info.approved"
                      ng-model="area.building"
                      typeahead="itm for itm in selfList('meta.areas.building')"
                      typeahead-wait-ms="typeaheadWait"
                      />
                  </div>

                  <div class="input-prepend">
                    <span class="add-on">ขนาด</span>
                    <input type="text" class="input-mini" 
                      ng-disabled = "resource.info.approved"
                      ng-model="area.size"
                      numeral="'qty'"
                      />
                  </div>

                </div>
              </div>
              
              <div>
                <textarea rows="1.5" class="input-xxlarge" 
                  ng-disabled = "resource.info.approved"
                  ng-model="resource.display.area" 
                  >
                </textarea>
                <span class="help-inline">ข้อความพื้นที่เช่าในสัญญา</span>
              </div>
              
              <label>
                ขนาดพื้่นที่ :
                <span ng-hide="(sumAreaSize() || resource.info.area_size) == resource.info.area_size"> 
                  <a href class="btn btn-small btn-info" ng-click="resource.info.area_size = sumAreaSize()">
                    sync
                  </a>
                </span>
              </label>
              <input type="text" class="input-small" 
                ng-disabled = "resource.info.approved"
                ng-model="resource.info.area_size"
                numeral="'qty'"
                 />
              <span style="padding-left:4px;"></span>
              <div class="input-prepend">
                <span class="add-on">เพิ่ม-ลด</span> 
                <input type="text" class="input-small" 
                  ng-disabled = "resource.info.approved"
                  ng-model="resource.info.area_xsize"
                  numeral="'qty'"
                   />
              </div>
              <div>
                <label>ประเภทกิจการ :   </label>
                <input type="text" class="input-xlarge" 
                  ng-model="resource.info.business_type"
                  typeahead="itm for itm in selfList('info.business_type',$viewValue)"
                  typeahead-wait-ms="typeaheadWait"
                   />

                <label>ชื่อร้าน :   </label>
                <input type="text" class="input-xlarge" 
                  ng-model="resource.info.shop_name"
                   />

                <label>เครื่องหมายการค้า :   </label>
                <input type="text" class="input-large" 
                  ng-model="resource.info.brand_name"
                   />

              </div>

              <label>
                ชนิดสินค้า :
                <span ng-show="!resource.info.approved">
                  <a href="" class="btn btn-small btn-danger" ng-click="resource$entry.add(goods())">
                    เพิ่ม
                  </a>
                </span>
              </label>
              <div class="alert alert-info" ng-show="goods().length">
                <div ng-repeat="g in goods()">
                  <div class="pull-right">
                    <a tabindex="-1" class="btn btn-small btn-warning" href 
                      ng-click="resource$entry.remove(goods(),$index)">
                      ลบ
                    </a>
                  </div>
                  <div class="input-prepend">
                      <span class="add-on">ชนิด</span>
                      <input type="text" class="input-large" 
                        ng-disabled = "resource.info.approved"
                        ng-model="g.name"
                        />
                  </div>
                </div>
              </div>

          </div>
            
          <div class="container-fluid" ng-show="__tabIdx==2" heading="กำหนดเวลา">
              <label>อายุสัญญา : </label>
              <input type="text" class="input-medium" placeholder="ระยะเวลา" 
                ng-disabled = "resource.info.approved"
                ng-model="resource.info.duration" 
                typeahead="itm for itm in selfList('info.duration', $viewValue)"
                typeahead-wait-ms="typeaheadWait"
                />
              
              <label>วันที่เริ่มเช่า : </label>
              <div class="input-append">
                <form style="margin:0;" ng-submit="sync_rent_date()">
                  <div style="height:0; width:0; overflow:hidden;">
                    <input type="submit" />
                  </div>                          

                  <input type="text" class="input-medium" placeholder="เริ่ม" 
                    ng-disabled = "resource.info.approved"
                    ng-model="resource.info.rent_date"
                    moment="'DD/MM/**BB'"
                    typeahead="d.name as (d.label || d.name) 
                      for d in utils.dateListAhead($viewValue) | filter:$viewValue"
                     />
                  <span class="add-on btn" 
                      ng-disabled = "resource.info.approved"
                      ng-class="!resource.info.approved && !rent_date_isSynced() && 'btn-info'"
                      ng-click="!resource.info.approved && sync_rent_date(true)"
                      >
                      &gt;
                    </a>
                  </span>
                </form>
              </div>
              <span style="padding-left:4px;"></span>
              <div class="input-prepend">
                <span class="add-on">ถึงวันที่ : </span>
                <input type="text" class="input-medium" placeholder="สิ้นสุด" 
                  ng-disabled = "resource.info.approved"
                  ng-model="resource.info.rent_until"
                  moment="'DD/MM/**BB'"
                  typeahead="d.name as (d.label || d.name) 
                    for d in utils.dateListAhead($viewValue) | filter:$viewValue"
                   />
              </div>

              <label>กำหนดตกแต่งสถานที่ : </label>
              <input type="text" class="input-medium" placeholder="เริ่ม" 
                ng-disabled = "resource.info.approved"
                ng-model="resource.info.decorate_date"
                moment="'DD/MM/**BB'"
                typeahead="d.name as (d.label || d.name) 
                  for d in utils.dateListAhead($viewValue) | filter:$viewValue"
                 />
              <span style="padding-left:4px;"></span>
              <div class="input-prepend">
                <span class="add-on">ถึงวันที่ : </span>
                <input type="text" class="input-medium" placeholder="สิ้นสุด" 
                  ng-disabled = "resource.info.approved"
                  ng-model="resource.info.decorate_until"
                  moment="'DD/MM/**BB'"
                  boot-datepicker="{language: 'th-th'}"
                   />
              </div>

              <label>กำหนดชำระค่าเช่า : </label>
              <input type="text" class="input-medium" placeholder="เริ่ม" 
                ng-disabled = "resource.info.approved"
                ng-model="resource.info.pay_date"
                moment="'DD/MM/**BB'"
                typeahead="d.name as (d.label || d.name) 
                  for d in utils.dateListAhead($viewValue) | filter:$viewValue"
                 />
              <span style="padding-left:4px;"></span>
              <div class="input-prepend">
                <span class="add-on">ถึงวันที่ : </span>
                <input type="text" class="input-medium" placeholder="สิ้นสุด" 
                  ng-disabled = "resource.info.approved"
                  ng-model="resource.info.pay_until"
                  moment="'DD/MM/**BB'"
                  typeahead="d.name as (d.label || d.name) 
                    for d in utils.dateListAhead($viewValue) | filter:$viewValue"
                   />
              </div>

              <label>กำหนดเปิดดำเนินงาน : </label>
              <input type="text" class="input-medium" placeholder="เริ่ม" 
                ng-disabled = "resource.info.approved"
                ng-model="resource.info.operate_date"
                moment="'DD/MM/**BB'"
                typeahead="d.name as (d.label || d.name) 
                  for d in utils.dateListAhead($viewValue) | filter:$viewValue"
                 />
          </div>
            
          <div class="container-fluid" ng-show="__tabIdx==3" heading="สัญญามาตรฐาน">

            <div class="row-fluid">
              <ul class="nav nav-tabs">
                <li ng-class="!__rateIdx && 'active'">
                  <a href ng-click="__rateIdx=0">
                    <span class="label label-success" 
                      ng-show="utils.notEmpty(rent_rates()) || resource.info.rental_prepaid"
                      >
                      &radic;
                    </span>
                    เซ้ง/เช่า</a></li>
                <li ng-class="__rateIdx==1 && 'active'">
                  <a href ng-click="__rateIdx=1">
                    <span class="label label-success" 
                      ng-show="utils.notEmpty(service_rates())"
                      >
                      &radic;
                    </span>
                    บริการ</a></li>
                <li ng-class="__rateIdx==2 && 'active'">
                  <a href ng-click="__rateIdx=2">
                    <span class="label label-success" 
                      ng-show="utils.notEmpty(utility_rates()) || resource.info.parking_rate"
                      >
                      &radic;
                    </span>
                    สาธารณูปโภค</a></li>
                <li ng-class="__rateIdx==3 && 'active'">
                  <a href ng-click="__rateIdx=3">
                    <span class="label label-success" 
                      ng-show="utils.notEmpty(pm_rates()) || utils.notEmpty(pm()) || utils.notEmpty(pm_utilities())"
                      >
                      &radic;
                    </span>
                    ส่งเสริมการขาย</a></li>
                <li ng-class="__rateIdx==4 && 'active'">
                  <a href ng-click="__rateIdx=4">
                    <span class="label label-success" 
                      ng-show="utils.notEmpty(atm())"
                      >
                      &radic;
                    </span>
                     ตู้ ATM</a></li>
                <li ng-class="__rateIdx==5 && 'active'">
                  <a href ng-click="__rateIdx=5">
                    <span class="label label-success" 
                      ng-show="utils.notEmpty(billboard())"
                      >
                      &radic;
                    </span>
                    ป้ายโฆษณา</a></li>
            </div>            

            <div class="row-fluid">

              <div class="container-fluid" ng-show="!__rateIdx" heading="เซ้ง/เช่า">

                <label>ค่าเช่าล่วงหน้า : </label>
                <input type="text" class="input-medium" 
                  ng-disabled = "resource.info.approved"
                  ng-model="resource.info.rental_prepaid"
                  numeral="'money'" 
                   />
              
                <label>เงินประกันการเช่า : </label>
                <input type="text" class="input-medium" 
                  ng-disabled = "resource.info.approved"
                  ng-model="resource.info.rental_deposit"
                  numeral="'money'" 
                   />
                
                <label>อัตราค่าเช่าพื้นที่ :  
                  <span ng-show="!resource.info.approved">
                    <a href="" class="btn btn-small btn-danger" ng-click="inc_rent_rates()">เพิ่ม</a>
                  </span>
                  <span ng-show="rent_rates().length &gt; 0 && !resource.info.approved" >
                    <a href="" class="btn btn-small btn-warning" ng-click="dec_rent_rates()">ลบ</a>
                  </span>
                </label>
                <div class="alert alert-info" ng-show="rent_rates().length">
                  <div ng-repeat="rate in rent_rates()">
                    <div class="input-prepend">
                      <span class="add-on">ข้อความ</span>
                      <input type="text" class="input-large" ng-model="rate.description" />
                    </div>
                    <span style="padding-left:4px;"></span>
                    <div class="input-prepend">
                      <span class="add-on">อัตรา</span>
                      <input type="text" class="input-medium" 
                        ng-disabled = "resource.info.approved"
                        ng-model="rate.value"
                        numeral="'money'" 
                         />
                    </div>
                  </div>
                </div>
              </div>

              <div class="container-fluid" ng-show="__rateIdx==1" heading="บริการ">

                <label>เงินประกันการบริการ : </label>
                <input type="text" class="input-medium" 
                  ng-disabled = "resource.info.approved"
                  ng-model="resource.info.service_deposit"
                  numeral="'money'" 
                   />
                
                <label>อัตราค่าบริการส่วนกลาง : 
                  <span ng-show="!resource.info.approved">
                    <a href="" class="btn btn-small btn-danger" ng-click="inc_service_rates()">เพิ่ม</a>
                  </span>
                  <span ng-show="service_rates().length &gt; 0 && !resource.info.approved" >
                    <a href="" class="btn btn-small btn-warning" ng-click="dec_service_rates()">ลบ</a>
                  </span>
                </label>
                <div class="alert alert-info" ng-show="service_rates().length">
                  <div ng-repeat="rate in service_rates()">
                    <div class="input-prepend">
                      <span class="add-on">ข้อความ</span>
                      <input type="text" class="input-large" ng-model="rate.description" />
                    </div>
                    <span style="padding-left:4px;"></span>
                    <div class="input-prepend">
                      <span class="add-on">อัตรา</span>
                      <input type="text" class="input-medium" 
                        ng-disabled = "resource.info.approved"
                        ng-model="rate.value"
                        numeral="'money'" 
                         />
                    </div>
                  </div>
                </div>
              </div>

              <div class="container-fluid" ng-show="__rateIdx==2" heading="สาธารณูปโภค">

                <label>อัตราค่าบริการจอดรถ : </label>
                <input type="text" class="input-medium" 
                  ng-disabled = "resource.info.approved"
                  ng-model="resource.info.parking_rate"
                  numeral="'money'" 
                   />

                <label>อัตราค่าบริการสาธารณูปโภค : 
                  <span ng-show="!resource.info.approved">
                    <a href="" class="btn btn-small btn-danger" ng-click="inc_utility_rates()">เพิ่ม</a>
                  </span>
                  <span ng-show="utility_rates().length &gt; 0 && !resource.info.approved" >
                    <a href="" class="btn btn-small btn-warning" ng-click="dec_utility_rates()">ลบ</a>
                  </span>
                </label>
                <div class="alert alert-info" ng-show="utility_rates().length">
                  <div ng-repeat="rate in utility_rates()">
                    <div class="input-prepend">
                      <span class="add-on">ข้อความ</span>
                      <input type="text" class="input-large" ng-model="rate.description" />
                    </div>
                    <span style="padding-left:4px;"></span>
                    <div class="input-prepend">
                      <span class="add-on">อัตรา</span>
                      <input type="text" class="input-medium" 
                        ng-disabled = "resource.info.approved"
                        ng-model="rate.value"
                        numeral="'money'" 
                         />
                    </div>
                  </div>
                </div>
              </div>

              <div class="container-fluid" ng-show="__rateIdx==3" heading="ส่งเสริมการขาย">

                <label>วัตถุประสงค์ : </label>
                <input type="text" class="input-xlarge" 
                  ng-disabled = "resource.info.approved"
                  ng-model="pm().description"
                  typeahead="itm for itm in selfList('info.pm.description',$viewValue)"
                  typeahead-wait-ms="typeaheadWait"
                   />

                <label>อัตรา GP: </label>
                <input type="text" class="input-small" 
                  ng-disabled = "resource.info.approved"
                  ng-model="pm().gp"
                  numeral="'0,0[.][00]%'" 
                   />

                <label>ค่าบริการพื้นที่ : 
                  <span ng-show="!resource.info.approved">
                    <a href="" class="btn btn-small btn-danger" ng-click="resource$entry.add(pm_rates())">เพิ่ม</a>
                  </span>
                  <span ng-show="pm_rates().length &gt; 0 && !resource.info.approved" >
                    <a href="" class="btn btn-small btn-warning" ng-click="resource$entry.remove(pm_rates())">ลบ</a>
                  </span>
                </label>
                <div class="alert alert-info" ng-show="pm_rates().length">
                  <div ng-repeat="rate in pm_rates()">
                    <div class="input-prepend">
                      <span class="add-on">งวดที่ {{ $index+1 }}</span>
                      <input type="text" class="input-medium" placeholder="จำนวนเงิน"
                        ng-disabled = "resource.info.approved"
                        ng-model="rate.value"
                        numeral="'money'" 
                         />
                    </div>
                    <div class="input-prepend">
                      <span class="add-on">ภายในวันที่</span>
                      <input type="text" class="input-medium" 
                        ng-disabled = "resource.info.approved"
                        ng-model="rate.date"
                        moment="'DD/MM/**BB'"
                        typeahead="d.name as (d.label || d.name) 
                          for d in utils.dateListAhead($viewValue) | filter:$viewValue"
                         />
                    </div>

                  </div>
                </div>

                <label>ติดตั้งโทรศัพท์ :</label>
                <div>
                  <div class="input-prepend">
                    <span class="add-on">จำนวน</span>
                    <input type="text" class="input-small" 
                      ng-disabled = "resource.info.approved"
                      ng-model="pm().tel_qty" 
                      numeral />
                  </div>
                  <div class="input-prepend">
                    <span class="add-on">ค่ามัดจำ</span>
                    <input type="text" placeholder="อัตราต่อหมายเลข" class="input-medium" 
                      ng-disabled = "resource.info.approved"
                      ng-model="pm().tel_deposit_rate" 
                      numeral="'money'"/>
                  </div>
                  <div class="input-prepend">
                    <span class="add-on">ค่าติดตั้ง</span>
                    <input type="text" placeholder="อัตราต่อหมายเลข" class="input-medium" 
                      ng-disabled = "resource.info.approved"
                      ng-model="pm().tel_install_rate" 
                      numeral="'money'"/>
                  </div>
                </div>

                <label>ประกันสาธารณูปโภค : </label>
                <input type="text" class="input-medium" 
                  ng-disabled = "resource.info.approved"
                  ng-model="pm().utils_deposit"
                  numeral="'money'" 
                   />

                <label>ค่าสาธารณูปโภค : 
                  <span ng-show="!resource.info.approved">
                    <a href="" class="btn btn-small btn-danger" ng-click="resource$entry.add(pm_utilities())">เพิ่ม</a>
                  </span>
                  <span ng-show="pm_utilities().length &gt; 0 && !resource.info.approved" >
                    <a href="" class="btn btn-small btn-warning" ng-click="resource$entry.remove(pm_utilities())">ลบ</a>
                  </span>
                </label>
                <div class="alert alert-info" ng-show="pm_utilities().length">
                  <div ng-repeat="rate in pm_utilities()">
                    <div class="input-prepend">
                      <span class="add-on">ข้อความ</span>
                      <input type="text" class="input-large" ng-model="rate.description" 
                        typeahead="itm for itm in selfList('meta.pm_utilities.description',$viewValue)"
                        typeahead-wait-ms="typeaheadWait"
                        />
                    </div>
                    <span style="padding-left:4px;"></span>
                    <div class="input-prepend">
                      <span class="add-on">อัตรา</span>
                      <input type="text" class="input-medium" 
                        ng-disabled = "resource.info.approved"
                        ng-model="rate.value"
                        numeral="'money'" 
                         />
                    </div>
                  </div>
                </div>

                <label>เงินประกันทำสัญญา : </label>
                <input type="text" class="input-medium" 
                  ng-disabled = "resource.info.approved"
                  ng-model="pm().coverage"
                  numeral="'money'" 
                   />
              </div>

              <div class="container-fluid" ng-show="__rateIdx==4" heading="ตู้ ATM">

                <label>วัตถุประสงค์ : </label>
                <input type="text" class="input-xlarge" 
                  ng-disabled = "resource.info.approved"
                  ng-model="atm().description"
                  typeahead="itm for itm in selfList('info.atm.description',$viewValue)"
                  typeahead-wait-ms="typeaheadWait"
                   />

                <label>อัตราค่าบริการ : </label>
                <input type="text" class="input-medium" 
                  ng-disabled = "resource.info.approved"
                  ng-model="atm().rate"
                  numeral="'money'" 
                   />

                <label>เงินประกัน วันทำสัญญา : </label>
                <input type="text" class="input-medium" 
                  ng-disabled = "resource.info.approved"
                  ng-model="atm().coverage"
                  numeral="'money'" 
                   />
              </div>

              <div class="container-fluid" ng-show="__rateIdx==5" heading="ป้ายโฆษณา">

                <label>จำนวนป้าย : </label>
                <input type="text" class="input-medium" 
                  ng-disabled = "resource.info.approved"
                  ng-model="billboard().qty"
                  numeral="'qty'" 
                   />

                <label>อัตราค่าบริการ : </label>
                <input type="text" class="input-medium" 
                  ng-disabled = "resource.info.approved"
                  ng-model="billboard().rate"
                  numeral="'money'" 
                   />

                <label>เงินประกันทำสัญญา : </label>
                <input type="text" class="input-medium" 
                  ng-disabled = "resource.info.approved"
                  ng-model="billboard().coverage"
                  numeral="'money'" 
                   />
              </div>

            </div>              
          </div>

          <div class="container-fluid" ng-show="__tabIdx==4" heading="กำหนดเอง">

            <div class="row-fluid">
              <div>
                <label>หัวสัญญา :
                </label>
                <input type="text" class="input-xxlarge" 
                  ng-disabled = "resource.info.approved"
                  ng-model="custom().title"
                  typeahead="itm for itm in selfList('info.custom.title',$viewValue)"
                  typeahead-wait-ms="typeaheadWait"
                   />
              </div>

            </div>

            <div class="row-fluid">
              <div>
                <label>หัวรอง :
                </label>
                <input type="text" class="input-xxlarge" 
                  ng-disabled = "resource.info.approved"
                  ng-model="custom().subTitle"
                  typeahead="itm for itm in selfList('info.custom.subTitle',$viewValue)"
                  typeahead-wait-ms="typeaheadWait"
                   />
              </div>
            </div>

            <div class="row-fluid">
              <div>
                <label>รหัสแบบสัญญา :
                </label>
                <input type="text" class="input-medium" 
                  placeholder="ช.ธญพ., บ.ธญพ. ฯลฯ"
                  ng-disabled = "resource.info.approved"
                  ng-model="custom().code"
                  typeahead="itm for itm in selfList('info.custom.code',$viewValue)"
                  typeahead-wait-ms="typeaheadWait"
                   />
              </div>
            </div>

            <div class="row-fluid">
              <a href tabindex="-1" class="btn btn-small" 
                ng-hide = "resource.info.approved"
                ng-class="__mdOpen && 'btn-warning'"
                ng-click="__mdOpen = !__mdOpen"
                >
                แก้ไข
              </a>
              <label class="checkbox inline">
                ใช้องค์ประกอบ :
              </label>
              <label class="checkbox inline">
                <input type="checkbox" 
                  ng-disabled = "resource.info.approved"
                  ng-model="custom().title_section" >
                title
              </label>
              <label class="checkbox inline">
                <input type="checkbox" 
                  ng-disabled = "resource.info.approved"
                  ng-model="custom().head_section" >
                หัว
              </label>
              <label class="checkbox inline">
                <input type="checkbox" 
                  ng-disabled = "resource.info.approved"
                  ng-model="custom().parties_section" >
                คู่สัญญา
              </label>
              <label class="checkbox inline">
                <input type="checkbox" 
                  ng-disabled = "resource.info.approved"
                  ng-model="custom().foot_section" >
                ท้าย(ลงนาม)
              </label>                   
            </div>

            <div class="page-boundary" ng-show="__mdOpen || custom().text">
              <div class="print-page">
               <div ng-include="'views/tvs/contract-print-custom.html'"></div>
              </div>
            </div>
          </div>

          <div class="container-fluid" ng-show="__tabIdx==5" heading="ฝ่ายกฏหมาย">
              <label>ครบกำหนด ท.ด.25 : </label>
              <input type="text" class="input-medium"
                ng-model="resource.info.td25_due"
                moment="'DD/MM/**BB'"
                typeahead="d.name as (d.label || d.name) 
                  for d in utils.dateListAhead($viewValue) | filter:$viewValue"
                 />
          </div>
        </div>
  

        <div ng-include="'views/includes/edit-footer.html'"> </div>
       
  </div> <!-- container -->
  